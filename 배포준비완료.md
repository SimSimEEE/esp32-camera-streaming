/\*\*

- `ë°°í¬ì¤€ë¹„ì™„ë£Œ.md`
-   - ë°°í¬ ì¤€ë¹„ ì™„ë£Œ ìš”ì•½ ë° ë¹ ë¥¸ ì‹¤í–‰ ê°€ì´ë“œ
-
- @author Sim Si-Geun <simsimee@lemoncloud.io>
- @date 2026-02-18 initial version
-
- @copyright (C) 2026 LemonCloud Co Ltd. - All Rights Reserved.
  \*/

# ğŸ‰ ë°°í¬ ì¤€ë¹„ ì™„ë£Œ!

## âœ… ì™„ë£Œëœ ì‘ì—…

- âœ… **Java ì„œë²„ v1.0.0** ë¹Œë“œ ì™„ë£Œ
- âœ… **Docker ì´ë¯¸ì§€** ìƒì„± ì™„ë£Œ (`esp32-camera-server:latest`)
- âœ… **ì›¹ í´ë¼ì´ì–¸íŠ¸** íŒŒì¼ ì¤€ë¹„ ì™„ë£Œ
- âœ… **ë°°í¬ ìŠ¤í¬ë¦½íŠ¸** ìƒì„± ì™„ë£Œ
- âœ… **ë¬¸ì„œ** ì‘ì„± ì™„ë£Œ

---

## ğŸš€ ë°°í¬ ë°©ë²•

### ë°©ë²• 1: ë¹ ë¥¸ ì¸í„°ë™í‹°ë¸Œ ë°°í¬ (â˜… ì¶”ì²œ)

```bash
./quick-deploy.sh
```

ë©”ë‰´ì—ì„œ ì„ íƒ:

- **ì˜µì…˜ 1**: ë¡œì»¬ Docker í…ŒìŠ¤íŠ¸ (ê°€ì¥ ë¹ ë¦„)
- **ì˜µì…˜ 2**: AWS í´ë¼ìš°ë“œ ë°°í¬ (ECR + S3)
- **ì˜µì…˜ 3**: ì „ì²´ ë°°í¬ (AWS + ESP32)
- **ì˜µì…˜ 4**: ESP32 íŒì›¨ì–´ë§Œ

### ë°©ë²• 2: ìˆ˜ë™ ë°°í¬

#### 1ï¸âƒ£ ë¡œì»¬ Docker ë°°í¬

```bash
# ì„œë²„ ì‹¤í–‰
cd esp32-camera-server
npm run start

# í´ë¼ì´ì–¸íŠ¸ ì‹¤í–‰ (ìƒˆ í„°ë¯¸ë„)
cd esp32-camera-client
npm run dev
```

**ì ‘ì†**: http://localhost:8080

#### 2ï¸âƒ£ AWS í´ë¼ìš°ë“œ ë°°í¬

```bash
# ì „ì²´ ìë™ ë°°í¬
./deploy-production.sh
```

ë˜ëŠ” ê°œë³„ ë°°í¬:

```bash
# ì„œë²„ë§Œ
cd esp32-camera-server
npm run push

# í´ë¼ì´ì–¸íŠ¸ë§Œ
cd esp32-camera-client
npm run deploy
```

**ì¤‘ìš”**: App Runner URLì„ [config.js](esp32-camera-client/config.js)ì— ì„¤ì • í•„ìš”!

#### 3ï¸âƒ£ ESP32 íŒì›¨ì–´

**ì‚¬ì „ ì¤€ë¹„**:

1. [Config.h](esp32-camera-firmware/ESP32_Camera_Stream/Config.h) ìˆ˜ì •
    - WiFi SSID/ë¹„ë°€ë²ˆí˜¸ ì„¤ì •
    - WebSocket ì„œë²„ URL ì„¤ì •

**ì—…ë¡œë“œ**:

```bash
cd esp32-camera-firmware

# PlatformIO ì‚¬ìš©
pio run --target upload

# ë˜ëŠ” Arduino IDE ì‚¬ìš©
# ESP32_Camera_Stream/ESP32_Camera_Stream.ino ì—´ê¸°
```

---

## ğŸ“‹ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

### í•„ìˆ˜ ìˆ˜ì • ì‚¬í•­

#### ESP32 íŒì›¨ì–´: [Config.h](esp32-camera-firmware/ESP32_Camera_Stream/Config.h)

```cpp
// WiFi ì„¤ì • (í•„ìˆ˜)
#define WIFI_SSID "YOUR_WIFI_SSID"           // â† ìˆ˜ì • í•„ìš” âš ï¸
#define WIFI_PASSWORD "YOUR_WIFI_PASSWORD"   // â† ìˆ˜ì • í•„ìš” âš ï¸

// WebSocket ì„œë²„ (ë¡œì»¬ í…ŒìŠ¤íŠ¸)
#define WS_HOST "192.168.1.100"              // â† ë¡œì»¬ PC IP
#define WS_PORT 8887

// ë˜ëŠ” AWS í”„ë¡œë•ì…˜
// #define WS_HOST "xxx.ap-northeast-2.awsapprunner.com"
// #define WS_PORT 443
```

#### ì›¹ í´ë¼ì´ì–¸íŠ¸: [config.js](esp32-camera-client/config.js)

```javascript
// AWS ë°°í¬ ì‹œì—ë§Œ ìˆ˜ì •
production: {
    wsUrl: 'wss://xxx.ap-northeast-2.awsapprunner.com/viewer',  // â† App Runner URL
    reconnectInterval: 3000,
    heartbeatInterval: 30000
}
```

---

## ğŸ” ë°°í¬ ê²€ì¦

### 1. ë¡œì»¬ í…ŒìŠ¤íŠ¸

```bash
# ì„œë²„ ìƒíƒœ í™•ì¸
docker ps | grep esp32-camera-server

# ë¡œê·¸ í™•ì¸
docker logs -f esp32-camera-server

# ì›¹ ì ‘ì†
http://localhost:8080
```

**ì²´í¬ë¦¬ìŠ¤íŠ¸**:

- [ ] ì›¹ í˜ì´ì§€ ë¡œë“œ
- [ ] WebSocket ì—°ê²° (ê°œë°œì ë„êµ¬ í™•ì¸)
- [ ] ë²„ì „ í‘œì‹œ (í•˜ë‹¨: Client v1.0.0, Server v1.0.0)

### 2. ESP32 ì—°ê²° í™•ì¸

```bash
# ì‹œë¦¬ì–¼ ëª¨ë‹ˆí„°
cd esp32-camera-firmware
pio device monitor
```

**ì˜ˆìƒ ì¶œë ¥**:

```
WiFi connected
IP address: 192.168.x.x
Connecting to WebSocket: ws://xxx:8887/esp32
WebSocket connected!
Camera initialized
Streaming started...
```

**ì²´í¬ë¦¬ìŠ¤íŠ¸**:

- [ ] WiFi ì—°ê²° ì„±ê³µ
- [ ] WebSocket ì—°ê²° ì„±ê³µ
- [ ] ì¹´ë©”ë¼ ì´ˆê¸°í™” ì„±ê³µ
- [ ] ì›¹ì—ì„œ ì˜ìƒ ìŠ¤íŠ¸ë¦¬ë° í™•ì¸
- [ ] LED ì œì–´ ë™ì‘ í™•ì¸

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
esp32-camera-streaming/
â”œâ”€â”€ esp32-camera-server/          # Java WebSocket ì„œë²„
â”‚   â”œâ”€â”€ src/main/java/io/granule/camera/server/
â”‚   â”‚   â”œâ”€â”€ CameraStreamServer.java       # ë©”ì¸ ì„œë²„
â”‚   â”‚   â”œâ”€â”€ config/ServerConfig.java      # ì„¤ì •
â”‚   â”‚   â””â”€â”€ module/                       # ëª¨ë“ˆ
â”‚   â”‚       â”œâ”€â”€ ConnectionManager.java    # ì—°ê²° ê´€ë¦¬
â”‚   â”‚       â”œâ”€â”€ LedStateManager.java      # LED ìƒíƒœ
â”‚   â”‚       â”œâ”€â”€ FrameRelayService.java    # í”„ë ˆì„ ì¤‘ê³„
â”‚   â”‚       â””â”€â”€ ViewerStatsService.java   # í†µê³„
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ esp32-camera-client/           # ì›¹ í´ë¼ì´ì–¸íŠ¸
â”‚   â”œâ”€â”€ index.html                 # UI
â”‚   â”œâ”€â”€ app.js                     # ë¡œì§
â”‚   â”œâ”€â”€ styles.css                 # ìŠ¤íƒ€ì¼
â”‚   â””â”€â”€ config.js                  # í™˜ê²½ ì„¤ì • âš ï¸
â”‚
â”œâ”€â”€ esp32-camera-firmware/         # ESP32 íŒì›¨ì–´
â”‚   â”œâ”€â”€ ESP32_Camera_Stream/
â”‚   â”‚   â”œâ”€â”€ ESP32_Camera_Stream.ino   # Arduino ë©”ì¸
â”‚   â”‚   â”œâ”€â”€ Config.h                  # í™˜ê²½ ì„¤ì • âš ï¸
â”‚   â”‚   â”œâ”€â”€ CameraModule.h/.cpp       # ì¹´ë©”ë¼ ëª¨ë“ˆ
â”‚   â”‚   â””â”€â”€ LedModule.h/.cpp          # LED ëª¨ë“ˆ
â”‚   â””â”€â”€ src/main.cpp               # PlatformIO ë©”ì¸
â”‚
â”œâ”€â”€ deploy-production.sh           # AWS ìë™ ë°°í¬
â”œâ”€â”€ quick-deploy.sh                # ì¸í„°ë™í‹°ë¸Œ ë°°í¬ â˜…
â”œâ”€â”€ DEPLOY_GUIDE.md                # ìƒì„¸ ë°°í¬ ê°€ì´ë“œ
â””â”€â”€ DEPLOYMENT.md                  # í´ë¼ìš°ë“œ ë°°í¬ ê°€ì´ë“œ
```

---

## ğŸ“š ë¬¸ì„œ ê°€ì´ë“œ

| ë¬¸ì„œ                               | ëª©ì               | ëŒ€ìƒ        |
| ---------------------------------- | ----------------- | ----------- |
| **ë°°í¬ì¤€ë¹„ì™„ë£Œ.md** (í˜„ì¬ ë¬¸ì„œ)    | ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ  | ëª¨ë“  ì‚¬ìš©ì |
| [DEPLOY_GUIDE.md](DEPLOY_GUIDE.md) | ìƒì„¸ ë°°í¬ ê°€ì´ë“œ  | ë°°í¬ ë‹´ë‹¹ì |
| [DEPLOYMENT.md](DEPLOYMENT.md)     | í´ë¼ìš°ë“œ ì•„í‚¤í…ì²˜ | DevOps      |
| [README.md](README.md)             | í”„ë¡œì íŠ¸ ê°œìš”     | ê°œë°œì      |

---

## âš¡ ë¹ ë¥¸ ëª…ë ¹ì–´ ì°¸ì¡°

### ê°œë°œ/í…ŒìŠ¤íŠ¸

```bash
# ì„œë²„ ë¡œì»¬ ì‹¤í–‰
cd esp32-camera-server && npm run start

# í´ë¼ì´ì–¸íŠ¸ ë¡œì»¬ ì‹¤í–‰
cd esp32-camera-client && npm run dev

# ë¡œê·¸ í™•ì¸
docker logs -f esp32-camera-server
```

### ë°°í¬

```bash
# ì¸í„°ë™í‹°ë¸Œ ë°°í¬ (ì¶”ì²œ)
./quick-deploy.sh

# AWS ì „ì²´ ë°°í¬
./deploy-production.sh

# ê°œë³„ ë°°í¬
cd esp32-camera-server && npm run push        # ì„œë²„
cd esp32-camera-client && npm run deploy      # í´ë¼ì´ì–¸íŠ¸
cd esp32-camera-firmware && pio run --target upload  # íŒì›¨ì–´
```

### ìœ ì§€ë³´ìˆ˜

```bash
# ì„œë²„ ì¬ì‹œì‘
docker restart esp32-camera-server

# ì„œë²„ ì¤‘ì§€
docker stop esp32-camera-server

# ì „ì²´ ì •ë¦¬
docker stop esp32-camera-server && docker rm esp32-camera-server
```

---

## ğŸ› ë¬¸ì œ í•´ê²°

### Q1: Docker ì´ë¯¸ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤

```bash
# ë‹¤ì‹œ ë¹Œë“œ
cd esp32-camera-server
mvn clean package -DskipTests
docker build -t esp32-camera-server:latest .
```

### Q2: ESP32ê°€ WiFiì— ì—°ê²°ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤

1. [Config.h](esp32-camera-firmware/ESP32_Camera_Stream/Config.h)ì˜ SSID/ë¹„ë°€ë²ˆí˜¸ í™•ì¸
2. 2.4GHz WiFi ì‚¬ìš© í™•ì¸ (5GHz ë¶ˆê°€)
3. ESP32 ì¬ë¶€íŒ…

### Q3: WebSocket ì—°ê²°ì´ ì•ˆ ë©ë‹ˆë‹¤

1. ì„œë²„ ì‹¤í–‰ í™•ì¸: `docker ps`
2. í¬íŠ¸ ê°œë°© í™•ì¸: 8887
3. [config.js](esp32-camera-client/config.js)ì˜ URL í™•ì¸
4. ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ ì½˜ì†” í™•ì¸

### Q4: AWS ë°°í¬ ì‹œ ê¶Œí•œ ì˜¤ë¥˜

```bash
# AWS ì¬ì„¤ì •
aws configure

# ê¶Œí•œ í™•ì¸
aws sts get-caller-identity
```

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

í˜„ì¬ ë°°í¬ ì¤€ë¹„ê°€ ëª¨ë‘ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!

**ì¶”ì²œ ìˆœì„œ**:

1. **ë¡œì»¬ í…ŒìŠ¤íŠ¸** (5ë¶„)

    ```bash
    ./quick-deploy.sh
    # ì˜µì…˜ 1 ì„ íƒ
    ```

2. **ESP32 ì—°ê²°** (10ë¶„)
    - Config.h ìˆ˜ì •
    - íŒì›¨ì–´ ì—…ë¡œë“œ
    - ì‹œë¦¬ì–¼ ëª¨ë‹ˆí„° í™•ì¸

3. **AWS ë°°í¬** (í•„ìš”ì‹œ)
    ```bash
    ./deploy-production.sh
    ```

---

## ğŸ“ ì§€ì›

ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

1. ë¡œê·¸ í™•ì¸ (`docker logs -f esp32-camera-server`)
2. ì‹œë¦¬ì–¼ ëª¨ë‹ˆí„° í™•ì¸ (`pio device monitor`)
3. ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ ì½˜ì†” í™•ì¸
4. ë¬¸ì„œ ì°¸ì¡° ([DEPLOY_GUIDE.md](DEPLOY_GUIDE.md))

---

**ë°°í¬ ì„±ê³µì„ ê¸°ì›í•©ë‹ˆë‹¤! ğŸ‰**

ì‹œì‘í•˜ë ¤ë©´:

```bash
./quick-deploy.sh
```
